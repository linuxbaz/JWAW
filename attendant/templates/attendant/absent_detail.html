{% extends "attendant/base_generic.html" %}

{% block content %}

{{test}}
  <p>  <strong>  لیست غیبت ها ی امروز: </strong></p>
  <h3>{{today_is}}  : تاریخ </h3>
  {% if absent_today_list %}
  <table class="table_style">
  <tr>
    <th>ردیف</th>
    <th>نوع غیبت</th>
    <th>کد ملی</th>
    <th>نام و نام خانوادگی</th>
    <th>ارسال پیام</th>
  </tr>
    {% for absent in absent_today_list %}
  <tr>
    <td><strong>{{ forloop.counter }} </strong></td>
    <td>{% for key, value in absent_type_help_text.items %}
      {% ifequal absent.absent_type  key %}
        {{ value }}
      {% endifequal %}
    {% endfor %}
  </td>
    <td><a href="{{ absent.student.get_absolute_url }}">{{ absent.student}}</a></td>
    <td>{{ absent.student.student_name}}</td>
    <td>
      <a class="likebutton" id="like{{absent.student}}" href="#" data-catid="{{absent.student}}">Like</a>
    </td>
  </tr>
    {% endfor %}

  </table>
  {% endif %}
  <hr/>
  <p><strong>لیست غیبت ها ی دیروز: </strong></p>

  {% if absent_yesterday_list %}

  <table class="table_style">
  <tr>
    <th>ردیف</th>
    <th>نوع غیبت</th>
    <th>کد ملی</th>
    <th>ارسال پیام</th>
  </tr>
    {% for absent in absent_yesterday_list %}
  <tr>
    <td><strong>{{ forloop.counter }} </strong></td>
    <td>
      {% for key, value in absent_type_help_text.items %}
        {% ifequal absent.absent_type  key %}
          {{ value }}
        {% endifequal %}
      {% endfor %}
      </td>
    <td><a href="{{ absent.student.get_absolute_url }}">{{ absent.student}}</a></td>
    <td>
      <a class="likebutton" id="like{{absent.student}}" href="#" data-catid="{{absent.student}}">Like</a>
    </td>
  </tr>
    {% endfor %}
  </table>
  {% endif %}
  <hr/>
  <p>لیست همه غیبت ها : </p>
  <table class="table_style">
  <tr>
    <th>ردیف</th>
    <th>تاریخ</th>
    <th>نوع غیبت</th>
  </tr>
  {% for val in absent_tuple_info %}
  <tr>
    <td><strong>{{ forloop.counter }} </strong></td>
    <td>{{ val.0 }}</td>
    <td>{% for key, value in absent_type_help_text.items %}
      {% ifequal val.1  key %}
        {{ value }}
      {% endifequal %}
    {% endfor %}
  </td>
  </tr>
  {% endfor %}
  </table>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script type="text/javascript">
  $('.likebutton').click(function(){
  var catid;
  catid = $(this).attr("data-catid");
  $.ajax(
  {
      type:"GET",
      url: "likestudent/",
      data:{
               student_id: catid
      },
      success: function( data )
      {
          $( '#like'+ catid ).remove();
          $( '#message' ).text(data);
      }
   })
  });
  </script>
{% endblock %}
